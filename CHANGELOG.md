# WinPE管理器更新日志

## v0.1.11 (2025-10-27)

### 🚀 新增功能
- **统一WIM操作系统** - 创建共享的WIM操作功能模块
  - WIMOperationsCommon类提供统一的挂载、卸载、目录管理功能
  - 支持多个界面复用相同的操作逻辑
- **挂载进度条显示** - 为挂载操作添加与卸载一致的进度条
  - 渐进式进度更新（10% → 80% → 100%）
  - 清晰的状态文本和视觉反馈
- **双日志系统** - WIM操作信息同时显示在构建日志和WIM操作日志中
  - 统一的时间戳和消息格式
  - 智能消息前缀（✅❌⚠️ℹ️）

### 🔧 功能改进
- **开始构建页面WIM操作** - 在开始构建页面添加WIM管理按钮
  - 挂载WIM - 蓝色按钮
  - 卸载保存 - 橙色按钮
  - 卸载不保存 - 红色按钮
- **自动列表刷新** - 挂载/卸载操作完成后自动刷新相关列表
  - WIM管理器列表自动更新
  - 构建目录列表自动更新
- **线程化操作** - 将挂载/卸载操作改为多线程执行
  - 避免UI冻结问题
  - 更好的用户响应体验

### 🛡️ 安全性修复
- **删除安全检查增强** - 修复删除选中功能清空所有目录的严重问题
  - 添加多层次安全检查机制
  - 防止删除工作空间目录和项目关键目录
  - 只允许删除WinPE_开头的构建目录
  - 防止删除系统目录和根目录
- **智能目录识别** - 精确区分工作空间和构建目录
  - WinPE_amd64（工作空间）- 禁止删除
  - WinPE_20251027_172520（构建目录）- 允许删除
  - 项目关键文件夹保护（core、ui、utils等）

### 🔌 用户体验优化
- **统一操作体验** - 两个界面使用相同的操作逻辑
  - 一致的错误处理和提示信息
  - 统一的进度条显示
  - 一致的日志格式
- **改进错误处理** - 更详细的错误信息和用户指导
- **界面交互优化** - 按钮状态管理和用户反馈

### 🧹 代码重构
- **创建共享模块** - `ui/shared/wim_operations_common.py`
- **减少代码重复** - 统一WIM操作实现
- **模块化设计** - 清晰的职责分离
- **回调机制** - 灵活的刷新和日志系统

### 🔧 技术改进
- **文件工具增强** - `utils/file_utils.py`安全检查函数
- **进度管理** - 统一的进度条更新机制
- **日志系统整合** - 多日志源统一管理
- **配置管理优化** - 更好的配置处理

---

## v0.1.10 (2025-10-26)

### 🚀 新增功能
- **完全重构的WIM管理系统** - 基于UnifiedWIMManager的新架构
  - 模块化设计：路径管理、检查管理、操作管理、状态管理
  - 统一的WIM文件扫描和管理
  - 智能挂载状态跟踪
  - 增强的错误恢复机制

### 🔧 功能改进
- **WIM管理器界面优化** - 重新设计的用户界面
  - 更清晰的WIM文件信息显示
  - 改进的挂载状态指示
  - 新增智能清理、诊断工具
  - 更好的操作反馈

### 🛡️ 稳定性提升
- **修复WIM挂载卡顿问题** - 添加超时机制和详细日志
- **MakeWinPEMedia参数修复** - 修复copype工具调用参数错误
- **模块导入错误修复** - 修复核心模块加载问题

### 🎯 用户体验
- **快速检查功能** - 一键检查WIM状态
- **智能清理** - 自动清理和恢复WIM环境
- **详细诊断** - 完整的系统状态报告
- **改进的日志显示** - 更好的操作追踪

---

## v0.1.9 (2025-10-25)

### 🚀 新增功能
- **WinPE构建目录管理** - 完全重构的构建目录管理系统
- **智能WIM扫描** - 自动发现和分类WIM文件
- **双击打开目录** - 快速访问构建目录
- **构建历史追踪** - 记录和管理所有构建项目

### 🔧 功能改进
- **配置文件结构优化** - 改进的配置管理系统
- **桌面环境集成** - Cairo和WinXShell支持
- **依赖检查增强** - 更全面的ADK和环境检测

---

## 版本历史

如需查看更早的版本更新，请参考项目的Git提交历史。